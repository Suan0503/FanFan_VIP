# 🎊 新年版功能開關系統使用指南

## 📋 概述

本系統提供了基於 TOKEN 的功能開關機制，讓您可以針對不同的群組控制可用功能，適合對外販售時進行功能分級管理。

## 🎨 新年風格選單

所有選單已更新為新年風格，包含：
- 🧧 紅金配色主題
- 🎊 新春祝福語
- 🏮 節慶氛圍元素

## 🔧 可控制的功能

系統支援以下功能開關：

| 功能代碼 | 功能名稱 | 說明 |
|---------|---------|------|
| `translate` | 翻譯功能 | 控制基本翻譯功能是否可用 |
| `voice` | 語音翻譯 | 控制語音翻譯功能開關 |
| `admin` | 管理功能 | 控制管理相關功能權限 |
| `auto_translate` | 自動翻譯 | 控制是否允許自動翻譯 |
| `statistics` | 統計功能 | 控制統計資料查詢功能 |

## 🎯 管理員指令

### 1. 查看群組功能狀態
```
/功能設定
或
/features
```
顯示目前群組啟用的功能和 TOKEN 資訊。

### 2. 開啟/關閉功能
```
/設定功能 [功能名稱]
```
範例：
- `/設定功能 translate` - 開啟/關閉翻譯功能
- `/設定功能 voice` - 開啟/關閉語音翻譯
- `/設定功能 statistics` - 開啟/關閉統計功能

### 3. 生成群組 TOKEN
```
/生成token
或
/generate_token
```
為群組生成唯一的 TOKEN，用於 API 存取控制或功能驗證。

## 📱 使用流程

### 情境 1：新群組初始設定
1. 機器人加入群組後，預設啟用所有功能
2. 主人可使用 `/功能設定` 查看當前狀態
3. 使用 `/設定功能` 調整需要的功能
4. 使用 `/生成token` 生成專屬 TOKEN

### 情境 2：對外販售功能分級
假設您要提供三種方案：

#### 基礎版（免費）
```
/設定功能 translate
/設定功能 auto_translate
```
只保留 `translate` 和 `auto_translate`

#### 進階版
```
/設定功能 translate
/設定功能 auto_translate
/設定功能 voice
/設定功能 statistics
```
加入語音翻譯和統計功能

#### 專業版
保留所有功能啟用（預設狀態）

### 情境 3：臨時關閉某功能
```
/設定功能 [功能名]
```
再次執行相同指令即可開啟/關閉切換

## 🔐 權限說明

- **主人（MASTER_USER_IDS）**: 可執行所有功能管理指令
- **群組管理員**: 可使用一般翻譯設定，但不能修改功能開關
- **一般用戶**: 受限於群組啟用的功能

## 💾 資料儲存

功能配置儲存在 `data.json` 中的 `feature_switches` 欄位：

```json
{
  "feature_switches": {
    "GROUP_ID_1": {
      "features": ["translate", "voice", "admin"],
      "token": "xxxxxxxxxxxxxxxx",
      "created_at": "2026-01-08T10:30:00"
    }
  }
}
```

## 🎁 使用者體驗

當用戶嘗試使用未啟用的功能時，會收到友善的提示訊息：
```
❌ 本群組未開啟[功能名稱]功能，請聯絡管理員。
```

## 🔄 預設行為

- 新群組加入時，預設啟用**所有功能**
- 未設定功能開關的群組，系統會回傳所有功能作為預設值
- 確保向下相容，不影響現有群組使用

## 📞 技術整合

### 在程式碼中檢查功能
```python
# 檢查功能是否啟用
if check_feature_enabled(group_id, "translate"):
    # 執行翻譯功能
    ...
else:
    # 回覆功能未啟用訊息
    ...
```

### 取得群組功能列表
```python
features = get_group_features(group_id)
# 回傳: ['translate', 'voice', 'admin', ...]
```

### 設定群組功能
```python
token = set_group_features(
    group_id, 
    ["translate", "voice"],
    token="existing_token_or_none"
)
```

## 🎨 新年特色

1. **視覺設計**: 紅金配色，充滿節慶氛圍
2. **祝福語**: 「恭喜發財 萬事如意」、「祝您新年快樂 龍年大吉」
3. **圖示更新**: 使用節慶相關 emoji（🎊、🧧、🏮）

## ⚠️ 注意事項

1. 功能開關僅影響**功能使用**，不影響資料儲存
2. TOKEN 請妥善保管，建議不要在群組內公開
3. 修改功能設定後立即生效，無需重啟
4. 建議定期備份 `data.json` 檔案

## 🚀 未來擴展

此功能開關系統設計為可擴展的，未來可以：
- 新增更多功能開關項目
- 整合付費驗證系統
- 提供功能使用量統計
- 建立 Web 管理後台

---

**祝您新年快樂，生意興隆！** 🎊🧧
